<!DOCTYPE html>
<html>
  <head>
    <script src="../jspsych.js"></script>
    <script src="../plugins/jspsych-survey-text.js"></script>
    <script src="../plugins/jspsych-image-keyboard-response.js"></script>
    <script src="../plugins/jspsych-survey-html-form.js"></script>
    <script src="../plugins/jspsych-html-button-response.js"></script>
    <script src="../plugins/jspsych-html-keyboard-response.js"></script>
    <script src="../plugins/jspsych-categorize-image.js"></script>
    <script src="../plugins/jspsych-call-function.js"></script>
    <link rel="stylesheet" href="../css/jspsych.css"></link>
  </head>
  <body></body>
  <script>
    timeline = [];
    var welcome = {
    type: "html-keyboard-response",
    stimulus: "Welcome to the experiment. Press any key to begin."
    }
    timeline.push(welcome)
    var ask_consent = function(elem) {
      if(document.getElementById('consent_checkbox').checked) {
      return true;
    }
    else {
      alert("Please consent before continuing.");
      return false;
    }
    return false;
    };

  var consent = {
    type: 'external-html',
    url: 'consent.html',
    cont_btn: "start",
    check_fn: ask_consent
  };
var pre_if_trial = {
    type: 'image-keyboard-response',
    stimulus: 'img/1.gif',
    prompt: 'The next trial is in a conditional statement. Press f for unfamiliar, or k for familiar.'
}

var if_trial = {
    type: 'survey-html-form',
    html: "<p><u>Identifer:</u> <input style='font-size: 18px; line-height: 1.6em;' input type='text' id='start' name='identifier'></p>"
}

var if_node = {
    timeline: [if_trial],
    conditional_function: function(){
        // get the data from the previous trial,
        // and check which key was pressed
        var data = jsPsych.data.get().last(1).values()[0];
        if(data.key_press == jsPsych.pluginAPI.convertKeyCharacterToKeyCode('f')){
            return false;
        } else {
            return true;
        }
    }
}

var after_if_trial = {
    type: 'image-keyboard-response',
    stimulus: '<img src="img/2.gif"></img>'
}

jsPsych.init({
    timeline: [pre_if_trial, if_node, after_if_trial, ],
    on_finish: function(){jsPsych.data.get().localSave('csv', 'mydata.csv'); }
});

  </script>
</html>
